
services:
  # A2A Communications Agent
  communications-agent:
    build:
      context: .
      dockerfile: agents/Dockerfile
      args:
        AGENT_NAME: communications_agent
    ports:
      - "10002:8000"
    env_file: agents/.env
    environment:
      GOOGLE_APPLICATION_CREDENTIALS: /tmp/keys/keyfile.json
    volumes:
      - $HOME/.config/gcloud/application_default_credentials.json:/tmp/keys/keyfile.json:ro
    networks:
      - agentic-network

  # A2A Cross-Selling Agent
  cross-selling-agent:
    build:
      context: .
      dockerfile: agents/Dockerfile
      args:
        AGENT_NAME: cross_selling_agent
    ports:
      - "10003:8000"
    env_file: agents/.env
    environment:
      MCP_CUSTOMER_CRM_URL: http://mcp-customer-crm:8002/mcp
      MCP_INSURANCE_PRODUCTS_URL: http://mcp-insurance-products:8003/mcp
      GOOGLE_APPLICATION_CREDENTIALS: /tmp/keys/keyfile.json
    volumes:
      - $HOME/.config/gcloud/application_default_credentials.json:/tmp/keys/keyfile.json:ro
    networks:
      - agentic-network
    depends_on:
      - mcp-customer-crm
      - mcp-insurance-products
    restart: unless-stopped

  # MCP Server - Customer CRM
  mcp-customer-crm:
    build:
      context: .
      dockerfile: mcp-servers/Dockerfile
      args:
        MCP_SERVER_NAME: customer_crm
    ports:
      - "${MCP_CUSTOMER_CRM_PORT:-8002}:8000"
    environment:
      - MCP_SERVER_PORT=8002
    networks:
      - agentic-network
    restart: unless-stopped

  # MCP Server - Insurance Products
  mcp-insurance-products:
    build:
      context: .
      dockerfile: mcp-servers/Dockerfile
      args:
          MCP_SERVER_NAME: insurance_products
    ports:
      - "${MCP_INSURANCE_PRODUCTS_PORT:-8003}:8000"
    environment:
      - MCP_SERVER_PORT=8003
    networks:
      - agentic-network
    restart: unless-stopped

networks:
  agentic-network:
    driver: bridge
