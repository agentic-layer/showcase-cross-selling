apiVersion: testworkflows.testkube.io/v1
kind: TestWorkflow
metadata:
  name: insurance-host-ragas-evaluation
  namespace: testkube
  labels:
    test-type: ragas-evaluation
    component: insurance-agents
    agent: insurance-host
spec:
  content:
    files:
      - path: /data/datasets/ragas_dataset.jsonl
        contentFrom:
          configMapKeyRef:
            name: datasets
            key: insurance-host-dataset.jsonl
      - path: /app/config/metrics.yaml
        contentFrom:
          configMapKeyRef:
            name: insurance-host-metrics-config
            key: metrics.yaml

  container:
    image: ghcr.io/agentic-layer/testbench/testworkflows:latest

  use:
    - name: ragas-run-template
      config:
        agentUrl: "http://insurance-host-agent.showcase-cross-selling:8000"
    - name: ragas-evaluate-template
      config:
        model: "gemini-2.5-flash-lite"
    - name: ragas-publish-template
    - name: ragas-visualize-template